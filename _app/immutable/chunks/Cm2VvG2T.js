var _=Object.defineProperty,R=(e,s,t)=>s in e?_(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t,r=(e,s,t)=>R(e,typeof s!="symbol"?s+"":s,t);function C(e,s){const t=e.getBoundingClientRect(),n=s.getBoundingClientRect(),i=t.top-n.top,o=t.left-n.left,l=i+s.scrollTop,a=o+s.scrollLeft;return{targetRect:t,containerRect:n,relativeTop:i,relativeLeft:o,targetTop:l,targetLeft:a}}function E(e,s){return e.left>=s.left&&e.right<=s.right}function d(e,s){let t="";if(e.translate){const{x:n,y:i}=e.translate;n!==void 0&&i!==void 0?t+=`translate(${n}, ${i}) `:n!==void 0?t+=`translateX(${n}) `:i!==void 0&&(t+=`translateY(${i}) `)}e.rotate!==void 0&&(t+=`rotate(${e.rotate}deg) `),e.scale!==void 0&&(t+=`scale(${e.scale}) `),s.style.transform=t}function v(e){return e.endsWith("%")}function j(e){return e/(180/Math.PI)}function P(e){return e*180/Math.PI}const B=Object.freeze({"right top":315,top:270,"left top":225,left:180,"left bottom":135,bottom:90,"right bottom":45,right:0}),I=Object.freeze({xs:.5,sm:.7,md:1,lg:1.25,xl:2,xxl:3}),N=Object.freeze({top:"center top","right top":"right top",right:"right center","right bottom":"right bottom",bottom:"center bottom","left bottom":"left bottom",left:"left center","left top":"left top"}),U=Object.freeze({center:"50%",left:"0%",right:"100%"}),q=Object.freeze({center:"50%",top:"0%",bottom:"100%"});function b(e){return+e.substring(0,e.length-1)}function x(e){const{x:s,y:t}=F(e);return{x:b(s),y:b(t)}}function F(e){let[s,t]=e.split(" ");return v(s)||(s=U[s]),v(t)||(t=q[t]),{x:s,y:t}}const c=Object.freeze({className:void 0,zIndex:9999}),g=Object.freeze({strokeColor:"darkorange",fillColor:"orange",strokeWidth:4});function H(e){const s={...c,...e},t=document.createElement("div");return t.style.zIndex=s.zIndex.toString(),t.style.position="absolute",t.style.transformOrigin="top left",t.classList.add("pio__pointer-wrapper"),s.className&&t.classList.add(s.className),t}function A(e,s=!1){const t={...c,...g,...e},n=document.createElementNS("http://www.w3.org/2000/svg","svg");return s&&(n.style.position="absolute",t.className&&n.classList.add(t.className)),n.style.zIndex=e.zIndex.toString(),n.style.stroke=t.strokeColor,n.style.fill=t.fillColor,n.style.strokeWidth=`${t.strokeWidth}`,n.style.pointerEvents="none",n.style.strokeLinejoin="round",n.style.strokeLinecap="round",n.style.strokeWidth=t.strokeWidth+"px",n}function f(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function X(e){return typeof e=="number"?e:B[e]}function Y(e){return typeof e=="number"?e:I[e]}function Z(e){if(typeof e=="string")return N[e];const s=typeof e.x=="number"?`${e.x}%`:e.x,t=typeof e.y=="number"?`${e.y}%`:e.y;return`${s} ${t}`}function u(e){return typeof e=="string"?document.querySelector(e):e}class O{constructor(s){r(this,"destroyed",!1),r(this,"target"),r(this,"container"),r(this,"listeners"),r(this,"on",(o,l)=>{if(this.listeners[o]===void 0)return this.listeners[o]=[l];this.listeners[o].includes(l)||this.listeners[o].push(l)});const t={...c,...s},n=u(t.container||document.body);if(!n)throw new Error(`PointItOut: container is ${n}. Check container option.`);getComputedStyle(n).position==="static"&&(n.style.position="relative");const i=u(s.target);if(!i)throw new Error(`PointItOut: Target is ${i}. Check target option.`);this.listeners={},this.container=n,this.target=i}destroy(){var s;if(this.destroyed)throw new Error("Pointer already destroyed");this.destroyed=!0,this.rootElement.remove(),(s=this.listeners.destroy)==null||s.forEach(t=>t(this))}}const D={direction:"alternate",duration:1,repeat:"infinite"};function G(e){return`${e.duration}s ease-in-out ${e.repeat} ${e.direction} pio__${e.name}`}function J(){let e=document.head.querySelector("#point-it-out-keyframes");return e||(e=document.createElement("style"),e.title="point-it-out-keyframes",e.id="point-it-out-keyframes",document.head.appendChild(e)),e}function K(e,s){const t=J();if(t.innerHTML.includes(`@keyframes pio__${e}`))return;let n=`@keyframes pio__${e} { `;Object.entries(s).forEach(([i,o])=>{n+=`${i}% { ${o} } `}),n+=" }",t.innerHTML+=n}const z={pulse:{0:"transform: scale(0.95);",100:"transform: scale(1.1);"}};function Q(e){return e in z}function M(e,s){typeof s=="string"&&(s={name:s}),s={...D,...s};const t=e.rootElement;t.style.animation=G(s),Q(s.name)&&K(s.name,z[s.name])}const S=Object.freeze({...c,...g,fillColor:"none",round:0,padding:{x:0,y:0},animate:!1});function V(e){return e?typeof e=="number"?{x:e,y:e}:{x:e.x??0,y:e.y??0}:S.padding}class tt extends O{constructor(s){const t={...S,...s};super(t),r(this,"rootElement"),r(this,"rectElm"),r(this,"round",0),r(this,"padding"),r(this,"animate",!1),r(this,"strokeWidth"),r(this,"strokeColor"),r(this,"fillColor"),this.rectElm=f("rect"),this.rootElement=A(t,!0),this.rootElement.appendChild(this.rectElm),this.container.appendChild(this.rootElement),this.round=t.round,this.padding=V(t.padding),this.strokeWidth=t.strokeWidth,this.strokeColor=t.strokeColor,this.fillColor=t.fillColor,t.animate&&M(this,t.animate),this.update()}update(){const{targetRect:s,targetTop:t,targetLeft:n}=C(this.target,this.container),i=this.strokeWidth,o=s.width+i*2+this.padding.x*2,l=s.height+i*2+this.padding.y*2,a=Math.round(i/2);this.rootElement.style.left=n-i-this.padding.x+"px",this.rootElement.style.top=t-i-this.padding.y+"px",this.rootElement.setAttribute("width",o.toString()),this.rootElement.setAttribute("height",l.toString()),this.rectElm.setAttribute("x",`${a}`),this.rectElm.setAttribute("y",`${a}`),this.rectElm.setAttribute("width",`${o-i}`),this.rectElm.setAttribute("height",`${l-i}`),typeof this.round=="object"?(this.rectElm.setAttribute("rx",`${this.round.rx}`),this.rectElm.setAttribute("ry",`${this.round.ry}`)):this.rectElm.setAttribute("rx",`${this.round}`)}}const k={rotate:{type:"rotate"},scale:{type:"scale",minScale:.25}},L={fromAngle:45,distance:0,scale:1,responsive:!1,animate:!1,transformOrigin:"left"};class W extends O{constructor(s){const t={...L,...s};if(super(t),r(this,"baseAngle",0),r(this,"responsiveAngle",0),r(this,"responsiveScale",0),r(this,"baseTranslation",{x:"0",y:"0"}),r(this,"rootElement"),r(this,"pointerElement"),r(this,"animate",!1),r(this,"responsive"),r(this,"transform"),r(this,"_transformOrigin"),r(this,"size"),r(this,"fromAngle"),r(this,"distance"),this.pointerElement=u(t.pointerElement),!this.pointerElement)throw new Error(`PointItOut: pointerElement is ${this.pointerElement}. Check pointerElement option.`);this.distance=t.distance,this.fromAngle=X(t.fromAngle),this.size=Y(t.scale),this.responsiveScale=this.size;const n=this.pointerElement.closest(".pio__pointer-wrapper");n?.remove(),this.rootElement=H(t),this.rootElement.appendChild(this.pointerElement),this.container.appendChild(this.rootElement),this._transformOrigin=Z(t.transformOrigin),this.pointerElement.style.transformOrigin=this._transformOrigin,this.pointerElement.style.overflow="visible",this.calculateBaseTranslation(),this.calculateBaseAngleBasedOnTransformOrigin(),this.transform={translate:{x:this.baseTranslation.x+"%",y:this.baseTranslation.y+"%"},scale:this.size,rotate:this.angle},t.responsive?typeof t.responsive=="object"?this.responsive={...k[t.responsive.type],...t.responsive}:this.responsive={...k[t.responsive]}:this.responsive=!1,t.animate&&M(this,t.animate),this.update()}get angle(){return this.fromAngle+this.baseAngle+this.responsiveAngle}get scale(){return this.responsive&&this.responsive.type=="scale"?this.responsiveScale:this.size}clearPointerElementPositionStyles(){["left","top","transform"].forEach(s=>this.pointerElement.style.removeProperty(s))}update(){this.clearPointerElementPositionStyles();const s=C(this.target,this.container),{targetRect:t,targetTop:n,targetLeft:i}=s;this.rootElement.style.left=i+t.width/2+"px",this.rootElement.style.top=n+t.height/2+"px",this.responsive&&(this.responsive.type=="rotate"?this.responsiveRotationUpdate(s.containerRect):this.responsive.type=="scale"&&this.responsiveScaleUpdate(s.containerRect)),this.calculateBaseTranslation(),this.transform={...this.transform,translate:{...this.baseTranslation},rotate:this.angle,scale:this.scale},d(this.transform,this.pointerElement)}calculateBaseAngleBasedOnTransformOrigin(){const{x:s,y:t}=x(this._transformOrigin),n=(s-50)/50,i=(t-50)/50;this.baseAngle=P(Math.atan2(i,n))-180}calculateBaseTranslation(){const{x:s,y:t}=x(this._transformOrigin);let n=0,i=0;if(this.distance){const o=j(this.fromAngle+this.responsiveAngle),l=Math.cos(o),a=Math.sin(o),y=this.pointerElement.getBoundingClientRect();n=this.distance*l/y.width*100,i=this.distance*a/y.height*100}this.baseTranslation={x:(n-s).toFixed(2)+"%",y:(i-t).toFixed(2)+"%"}}responsiveScaleUpdate(s){this.transform={...this.transform,scale:this.size,rotate:this.angle},d(this.transform,this.pointerElement);const t=this.pointerElement.getBoundingClientRect();if(E(t,s))return!1;let n=0;t.right>s.right&&(n+=t.right-s.right),t.left<s.left&&(n+=s.left-t.left);const i=this.angle%90,o=Math.min(i,90-i),l=n/(t.width*Math.cos(o/180*Math.PI)),a=this.responsive;return this.responsiveScale=Math.max(a.minScale,this.size*(1-l)),!0}responsiveRotationUpdate(s){this.responsiveAngle=0;const t={...this.transform,rotate:this.angle};d(t,this.pointerElement);const n=this.pointerElement.getBoundingClientRect();if(E(n,s))return!1;const i=this.angle<0||this.angle>=180,o=this.angle>90&&this.angle<=270;let l=1-(o?s.left-n.left:n.right-s.right)/(s.width/2);l=Math.min(1,Math.max(-1,l));let a=Math.acos(l)*(180/Math.PI);return(i&&!o||o&&!i)&&(a=-a),o?i?a=Math.min(a,270-this.angle):a=Math.max(a,90-this.angle):i?a=Math.max(a,270-this.angle):a=Math.min(a,90-this.angle),this.responsiveAngle=a,!0}}function et(e,s,t){return`M${t/2} ${e/2+t/2} L${s/2+t/2} ${e+t/2} l0 -${e/3} l${s/2} 0 l0 -${e/3} l-${s/2} 0 l0 -${e/3} Z`}const st=Object.freeze({...c,...g,...L,strokeWidth:0,transformOrigin:"left"});class nt extends W{constructor(s){const t={...st,...s},n=A(t);n.style.fill=t.fillColor,n.style.stroke=t.strokeColor,n.style.strokeWidth=`${t.strokeWidth==0?"none":t.strokeWidth}`,n.setAttribute("width",`${128+t.strokeWidth}`),n.setAttribute("height",`${96+t.strokeWidth}`);const i=f("path"),o=f("g");i.setAttribute("d",et(96,128,t.strokeWidth)),o.appendChild(i),n.appendChild(o),super({...t,pointerElement:n}),r(this,"path"),r(this,"strokeWidth"),r(this,"strokeColor"),r(this,"fillColor"),r(this,"animate",!1),this.strokeWidth=t.strokeWidth,this.fillColor=t.fillColor,this.strokeColor=t.strokeColor,this.path=i,this._transformOrigin="left center",d(this.transform,this.pointerElement),this.update()}}const p=new Set,w=()=>{T()},m=()=>{T()};let h={updateOnResize:!0,updateAfterLoad:!0},$=!1;function it(e){p.delete(e)}function rt(e){return h={...h,...e},window.removeEventListener("resize",w),window.removeEventListener("load",m),h.updateOnResize&&window.addEventListener("resize",w),h.updateAfterLoad&&window.addEventListener("load",m),structuredClone(h)}function ot(e,s){$||(rt(h),$=!0,h.updateAfterLoad&&document.readyState=="complete"&&m());let t;return e=="rect"?t=new tt(s):e=="arrow"?t=new nt(s):e=="free"&&(t=new W(s)),t.on("destroy",it),p.add(t),t}function at(){p.forEach(e=>e.destroy())}function T(){p.forEach(e=>e.update())}export{T as I,at as h,ot as l};
